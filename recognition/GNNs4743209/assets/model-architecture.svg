<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
    <!-- Background -->
    <rect width="800" height="400" fill="#ffffff"/>
    
    <!-- Input Layer -->
    <g transform="translate(50,50)">
        <rect x="0" y="0" width="120" height="80" rx="5" fill="#e3f2fd" stroke="#1565c0" stroke-width="2"/>
        <text x="60" y="35" text-anchor="middle" font-family="Arial" font-size="14">Input Features</text>
        <text x="60" y="55" text-anchor="middle" font-family="Arial" font-size="12">(N × 128)</text>
    </g>
    
    <!-- Input GNN Block -->
    <g transform="translate(200,30)">
        <rect x="0" y="0" width="140" height="120" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
        <text x="70" y="25" text-anchor="middle" font-family="Arial" font-size="14">Input GNN Block</text>
        <rect x="20" y="35" width="100" height="25" rx="3" fill="#81c784" stroke="#2e7d32"/>
        <text x="70" y="52" text-anchor="middle" font-family="Arial" font-size="12" fill="white">Conv Layer</text>
        <rect x="20" y="65" width="100" height="20" rx="3" fill="#a5d6a7" stroke="#2e7d32"/>
        <text x="70" y="80" text-anchor="middle" font-family="Arial" font-size="11">BatchNorm</text>
        <rect x="20" y="90" width="100" height="20" rx="3" fill="#c8e6c9" stroke="#2e7d32"/>
        <text x="70" y="104" text-anchor="middle" font-family="Arial" font-size="11">ReLU + Dropout</text>
    </g>
    
    <!-- Hidden GNN Blocks -->
    <g transform="translate(370,30)">
        <rect x="0" y="0" width="140" height="120" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
        <text x="70" y="25" text-anchor="middle" font-family="Arial" font-size="14">Hidden GNN Block</text>
        <rect x="20" y="35" width="100" height="25" rx="3" fill="#81c784" stroke="#2e7d32"/>
        <text x="70" y="52" text-anchor="middle" font-family="Arial" font-size="12" fill="white">Conv Layer</text>
        <rect x="20" y="65" width="100" height="20" rx="3" fill="#a5d6a7" stroke="#2e7d32"/>
        <text x="70" y="80" text-anchor="middle" font-family="Arial" font-size="11">BatchNorm</text>
        <rect x="20" y="90" width="100" height="20" rx="3" fill="#c8e6c9" stroke="#2e7d32"/>
        <text x="70" y="104" text-anchor="middle" font-family="Arial" font-size="11">ReLU + Dropout</text>
    </g>
    
    <!-- Dots for multiple layers -->
    <g transform="translate(520,85)">
        <circle cx="10" cy="0" r="4" fill="#2e7d32"/>
        <circle cx="30" cy="0" r="4" fill="#2e7d32"/>
        <circle cx="50" cy="0" r="4" fill="#2e7d32"/>
    </g>
    
    <!-- MLP Layers -->
    <g transform="translate(600,30)">
        <rect x="0" y="0" width="140" height="120" rx="5" fill="#fff3e0" stroke="#ef6c00" stroke-width="2"/>
        <text x="70" y="25" text-anchor="middle" font-family="Arial" font-size="14">MLP Layers</text>
        <rect x="20" y="35" width="100" height="25" rx="3" fill="#ffb74d" stroke="#ef6c00"/>
        <text x="70" y="52" text-anchor="middle" font-family="Arial" font-size="12">Hidden Layer</text>
        <rect x="20" y="65" width="100" height="20" rx="3" fill="#ffd54f" stroke="#ef6c00"/>
        <text x="70" y="80" text-anchor="middle" font-family="Arial" font-size="11">ReLU</text>
        <rect x="20" y="90" width="100" height="20" rx="3" fill="#ffe082" stroke="#ef6c00"/>
        <text x="70" y="104" text-anchor="middle" font-family="Arial" font-size="11">Output Layer</text>
    </g>
    
    <!-- Arrows -->
    <g stroke="#666" stroke-width="2" fill="none">
        <path d="M170,90 H200" marker-end="url(#arrowhead)"/>
        <path d="M340,90 H370" marker-end="url(#arrowhead)"/>
        <path d="M510,90 H600" marker-end="url(#arrowhead)"/>
    </g>
    
    <!-- Residual Connections -->
    <path d="M240,20 Q440,0 640,20" stroke="#2e7d32" stroke-width="2" stroke-dasharray="5,5" fill="none"/>
    
    <!-- Arrow marker definition -->
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
        </marker>
    </defs>
    
    <!-- Labels -->
    <g transform="translate(50,200)">
        <rect x="0" y="0" width="700" height="170" rx="5" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="1"/>
        <text x="20" y="30" font-family="Arial" font-size="14" font-weight="bold">Model Details:</text>
        <text x="20" y="60" font-family="Arial" font-size="12">• Input: Node features (128 dimensions) + Graph structure</text>
        <text x="20" y="85" font-family="Arial" font-size="12">• GNN Blocks (×8):</text>
        <text x="40" y="105" font-family="Arial" font-size="12">- Configurable convolution type (GCN/GAT/SAGE)</text>
        <text x="40" y="125" font-family="Arial" font-size="12">- Batch normalization and ReLU activation</text>
        <text x="40" y="145" font-family="Arial" font-size="12">- Dropout (p=0.5) and residual connections</text>
        <text x="20" y="165" font-family="Arial" font-size="12">• Final MLP: Hidden layer (256 units) → ReLU → Output layer → Log-softmax</text>
    </g>
</svg>
